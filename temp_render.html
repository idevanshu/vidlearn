<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>p5.js Animation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ccapture.js@1.1.0/build/CCapture.all.min.js"></script>
    <style>
      body {
        margin: 0;
        overflow: hidden;
        background: black;
      }
    </style>
  </head>
  <body>
    <script>
      let startTime;
let duration = 360; // 6 seconds at 60 FPS
let transitionFrames = 60;

function setup() {
  createCanvas(800, 600);
  startTime = frameCount;
  noStroke();
  textFont('Arial');
  textAlign(CENTER, CENTER);
}

function draw() {
  background(0);
  let elapsed = frameCount - startTime;

  // Phase 1: Chairs and Table Formation
  if (elapsed < transitionFrames) {
    let t = map(elapsed, 0, transitionFrames, 0, 1);
    drawTableAndChairs(t);
  } else {
    drawTableAndChairs(1);

    // Phase 2: Participants Slide In
    if (elapsed < transitionFrames * 2) {
      let t = map(elapsed, transitionFrames, transitionFrames * 2, 0, 1);
      drawParticipants(t);
    } else {
      drawParticipants(1);

      // Phase 3: Chart and Discussion Appearance
      if (elapsed < transitionFrames * 3) {
        let t = map(elapsed, transitionFrames * 2, transitionFrames * 3, 0, 1);
        drawChartAndDiscussion(t);
      } else {
        drawChartAndDiscussion(1);
      }
    }
  }

  // Text overlays
  if (elapsed > transitionFrames * 2) {
    fill(255, 255, 255, (elapsed - transitionFrames * 2) / transitionFrames * 255);
    textSize(20);
    text("While democracy offers many benefits,", width / 2, height - 80);
    text("it requires active participation and vigilance from its citizens.", width / 2, height - 50);
  }
  
  // Stop animation after duration
  if (elapsed > duration) {
    noLoop();
  }
}

function drawTableAndChairs(t) {
  let tableWidth = 200;
  let tableHeight = 100;
  fill(50, 50, 50, 255 * t);
  rectMode(CENTER);
  rect(width / 2, height / 2, tableWidth, tableHeight);

  let chairDistance = 150;
  fill(70, 70, 70, 255 * t);
  ellipse(width / 2 - chairDistance * t, height / 2 + chairDistance / 2 * t, 30, 30);
  ellipse(width / 2 + chairDistance * t, height / 2 + chairDistance / 2 * t, 30, 30);
  ellipse(width / 2, height / 2 - chairDistance * t, 30, 30);
}

function drawParticipants(t) {
  let participantSize = 20;
  fill(100, 200, 250, 255 * t);
  ellipse(width / 2 - 75 * t, height / 2, participantSize, participantSize);
  ellipse(width / 2 + 75 * t, height / 2, participantSize, participantSize);
  ellipse(width / 2, height / 2 + 50 * t, participantSize, participantSize);
}

function drawChartAndDiscussion(t) {
  fill(180, 180, 180, 230 * t);
  rect(width / 2, height / 2 - 180, 150, 90);
  
  stroke(255, 255, 255, 230 * t);
  line(width / 2 - 65, height / 2 - 155, width / 2 + 65, height / 2 - 155);
  line(width / 2 - 65, height / 2 - 135, width / 2 + 65, height / 2 - 135);
  line(width / 2 - 65, height / 2 - 115, width / 2 + 65, height / 2 - 115);
  noStroke();
  
  fill(255, 255, 255, 230 * t);
  for (let i = 0; i < 5; i++) {
    let y = height / 2 - 180 + i * 18;
    ellipse(width / 2 - 65, y, 5, 5);
  }
}
    </script>
  </body>
</html>